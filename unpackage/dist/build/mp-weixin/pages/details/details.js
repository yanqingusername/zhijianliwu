(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/details/details"],{1336:function(o,e,s){"use strict";(function(o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,s("24d7");var i=n(s("e2fe")),t=n(s("e56b"));function n(o){return o&&o.__esModule?o:{default:o}}function c(o,e,s){return e in o?Object.defineProperty(o,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[e]=s,o}var r=function(){s.e("components/own-components/own-coupon-list/own-coupon-list").then(function(){return resolve(s("811e"))}.bind(null,s)).catch(s.oe)},l=function(){Promise.all([s.e("common/vendor"),s.e("components/feng-parse/parse")]).then(function(){return resolve(s("6551"))}.bind(null,s)).catch(s.oe)},a={components:{uParse:l,"own-coupon-list":r},data:function(){var o;return o={num_all:0,btns:0,fixed:!1,list:[],display:!1,commom:"details-choose-left details-choose-active",commom1:"details-choose-left",img:!0,details:[],indexNav:[{name:"热门",style:"color:#FF0022;border-bottom:4.16rpx solid #FF0022;"},{name:"情人节"},{name:"夏日防暑"},{name:"9.9包邮"},{name:"美物"},{name:"热门"},{name:"情人节"}],alt:"",text:"",text1:"",choose:[{src:"../../static/details-small.jpg"},{src:"../../static/details-small.jpg"},{src:"../../static/details-small.jpg"},{src:"../../static/details-small.jpg"},{src:"../../static/details-small.jpg"},{src:"../../static/details-small1.jpg"},{src:"../../static/details-small1.jpg"},{src:"../../static/details-small1.jpg"},{src:"../../static/details-small1.jpg"},{src:"../../static/details-small1.jpg"}],id:"",goods_model:"",goods_spec:[0],goods_item:["默认"],discount_name:"",level_name:"",level:"",images:"",head_img:"",arr:[],first:[],btmdetails:"",btmnotice:"",btm:!0,listdisplay:!1,scrollTop:"",tt:[],top:"",keynum:"",sta:"",openid:"",Data:"",specArr:{},url:"",couponList:[],goodsinfo:{}},c(o,"goods_item",""),c(o,"guige",[]),c(o,"checknum","1"),c(o,"swiperCurrentIndex",1),o},onLoad:function(e){var s=this;this.url=i.default.URL,console.log(e),console.log("我执行了");var n=decodeURIComponent(e.scene);e.keynum?this.keynum=e.keynum:this.keynum=n,this.level_name=o.getStorageSync("level_name"),console.log(this.level_name),this.level=o.getStorageSync("level"),this.discount_name=o.getStorageSync("discount_name"),this.id=o.getStorageSync("id");var c=o.getStorageSync("id"),r='{"keynum":"'+this.keynum+'","memberid":"'+c+'"}';console.log(r);var l="get_goods_detail";this.$utils.post(l,r).then((function(o){console.log("res： ",o),console.log("详情",o.rs.goodsinfo),s.goodsinfo=o.rs.goodsinfo,t.default.track("browse_sku_page",{sku:{sku_id:s.goodsinfo.id+"",sku_name:s.goodsinfo.goodsname},spu:{spu_id:s.goodsinfo.id+"",spu_name:s.goodsinfo.goodsname},primary_image_url:s.goodsinfo.head_img});var e,i,n,c=JSON.stringify({memberid:s.id,goodsid:s.goodsinfo.id}),r="get_coupon_list";if(s.$utils.post(r,c).then((function(o){console.log(),s.couponList=o.rs})),s.head_img=o.rs.goodsinfo.head_img,o.rs.goodsinfo.images){var l=o.rs.goodsinfo.images.split("|");l.unshift(o.rs.goodsinfo.head_img),s.details=l}for(var a in s.num_all=o.rs.goodsinfo.buy_shopping_cart_number,s.text=o.rs.goodsinfo.goods_spec.length,s.text1=o.rs.goodsinfo.goods_spec_list.length,console.log("规格",o.rs.goodsinfo.goods_spec),o.rs.goodsinfo.discount_name1=(o.rs.goodsinfo.price_level1/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name2=(o.rs.goodsinfo.price_level2/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name3=(o.rs.goodsinfo.price_level3/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name4=(o.rs.goodsinfo.price_level4/o.rs.goodsinfo.price*10).toFixed(1)+"折",s.alt=o.rs.goodsinfo,s.specifications=o.rs.goodsinfo.goods_spec_list,s.goods_model=o.rs.goodsinfo.goods_model,s.list=o.rs.goodsinfo.goods_spec_list,o.rs.goodsinfo.goods_spec)o.rs.goodsinfo.goods_spec[a].one=a;s.btmdetails=o.rs.goodsinfo.details.replace(/<img /g,'<img class="rich_img" '),s.choose=o.rs.goodsinfo.goods_spec,s.goodsid=o.rs.goodsinfo.id,console.log("礼篮"),1==o.rs.goodsinfo.goods_spec.length&&1==o.rs.goodsinfo.goods_spec.goods_spec_item&&(s.goods_spec=[0],s.goods_item=[o.rs.goodsinfo.goods_spec.goods_spec_item]);var d=s.goods_spec,g=s.goods_item,u=s.first,m=s.arr,h=s.specArr;if(s.choose.length>0)for(var p in s.choose){var f=s.choose[p],_=f.goods_spec_item;for(var v in e=f.one,d.push(e),u.splice(0,1),m.splice(0,1),-1==u.indexOf(e)&&u.push(e),_){var y=_[0];i=v,n=y.item,-1==m.indexOf(i)&&m.push(h),h[e]=n}}d=Object.keys(h),g=Object.values(h),s["guige"]=g,console.log(s.guige.join(","))}));r="{}",l="get_webconfig_tiaoli";this.$utils.post(l,r).then((function(o){console.log("赠礼须知"),o.rs.zenglixuzhi,s.btmnotice=o.rs.zenglixuzhi.replace(/<img /g,'<img class="rich_img" ')}));var a=o.getStorageSync("sign");a?this.sta="200":(this.open(),this.sta="0")},onShareAppMessage:function(o){return this.$refs.popup.close(),t.default.track("page_share_app_message",{from_type:"menu",share_title:"我发现了一份不错的礼物，快来看看吧！",share_path:"/pages/details/details?keynum="+this.keynum,share_image_url:"",share_to:"friends"}),{imageUrl:this.alt.head_img,title:"我发现了一份不错的礼物，快来看看吧！",path:"/pages/details/details?keynum="+this.keynum,desc:"指间送礼"}},computed:{selectOption:function(){return this.goods_item}},methods:{firend:function(e){this.$refs.popup.close(),o.navigateTo({url:"./detailsshare?keynum=".concat(this.keynum,"&imageUrl=").concat(this.head_img,"&goodsname=").concat(this.alt.goodsname)})},trackClick:function(o){t.default.track("start_consult",{action_type:"consult_online"})},reduce:function(e,s,i){var n,c=parseInt(e);1==s?(c++,n="append_to_cart"):(c--,n="remove_from_cart"),c<1?o.showToast({title:"商品购买数量最少一个",mask:!0,icon:"none"}):(t.default.track("add_to_cart",{action_type:n,sku:{sku_id:this.goodsinfo.id+"",sku_name:this.goodsinfo.goodsname},spu:{spu_id:this.goodsinfo.id+"",spu_name:this.goodsinfo.goodsname},sku_num:c,primary_image_url:this.goodsinfo.head_img}),this.checknum=parseInt(c))},handleSelect:function(o){this.goods_item=o,console.log("----\x3e:",o)},join:function(o){var e=o.currentTarget.dataset.index;0==e?(this.commom="details-choose-left details-choose-active",this.commom1="details-choose-left",this.img=!0,this.btm=!0):(this.commom1="details-choose-left details-choose-active",this.commom="details-choose-left",this.img=!1,this.btm=!1)},goshop:function(o){this.btns=2;var e=0;this.display=!this.display,this.fixed=!0,console.log("打开商品规格"),0==e&&(console.log(this.scrollTop),e++)},lilan:function(e){var s=this,i=o.getStorageSync("id");if(i){this.btns=3;var t=0;return this.display=!this.display,this.fixed=!0,console.log("打开商品规格"),void(0==t&&(console.log(this.scrollTop),t++))}o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(e){setTimeout((function(e){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+s.keynum})}),500)}})},meshop:function(){},list_speci:function(o){this.btns=1,console.log(this.text);var e=0;this.display=!this.display,this.fixed=!0,console.log("打开商品规格"),0==e&&(console.log(this.scrollTop),e++);var s="get_goods_detail",i=JSON.stringify({memberid:this.id,goodsid:this.goodsinfo.id,goods_model:this.goodsinfo.goods_model,spec_name:this.goodsinfo["goods_spec"][0]["spec_name"],goods_spec:this.goodsinfo["goods_spec"][0]["id"],goods_item:this.goodsinfo["goods_spec"][0]["goods_spec_item"][0]["item"]});this.$utils.post(s,i).then((function(o){console.log(o)}))},close:function(o){console.log("关闭规格"),this.display=!1,this.fixed=!1,this.scrolle()},determine1:function(e){var s=this,i=o.getStorageSync("id");if(i){console.log("确定规格"),this.display=!1,this.fixed=!1;var t="op_buy_shopping_cart",n=this.id,c=this.goodsid,r=this.goods_model,l=String(Object.keys(this.specArr)),a=String(Object.values(this.specArr)).replace("#","替换u35");console.log(a);var d=JSON.stringify({memberid:n,goodsid:c,goods_model:r,goods_spec:l,goods_item:a,num:this.checknum,buy_type:1});console.log(d),this.$utils.post(t,d).then((function(e){console.log(e+"直接购买");var s="success";if(1!=e.sta)return s="none",void o.showToast({icon:s,title:e.msg,duration:2e3});""!=a&&o.navigateTo({url:"../shopping/must?type=1"})})),this.scrolle()}else o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(e){setTimeout((function(e){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+s.keynum})}),500)}})},determine2:function(e){var s=this,i=o.getStorageSync("id");if(i){console.log("确定规格"),this.display=!1,this.fixed=!1;var t="op_buy_shopping_cart",n=this.id,c=this.goodsid,r=this.goods_model,l=String(Object.keys(this.specArr)),a=String(Object.values(this.specArr)).replace("#","替换u35");console.log(a);var d=JSON.stringify({memberid:n,goodsid:c,goods_model:r,goods_spec:l,goods_item:a,num:this.checknum,buy_type:1});this.$utils.post(t,d).then((function(e){console.log("直接赠送"),console.log(e);var s="success";if(1!=e.sta)return s="none",void o.showToast({icon:s,title:e.msg,duration:2e3});""!=a&&o.redirectTo({url:"../shopping/shop?type=1"})})),this.scrolle()}else o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(e){setTimeout((function(e){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+s.keynum})}),500)}})},determine3:function(e){var s=this,i=this,t=o.getStorageSync("id");if(t){this.display=!1,this.fixed=!1;var n="op_buy_shopping_cart",c=this.id,r=this.goodsid,l=this.goods_model,a=String(Object.keys(this.specArr)),d=String(Object.values(this.specArr)).replace("#","替换u35"),g=JSON.stringify({memberid:c,goodsid:r,goods_model:l,goods_spec:a,goods_item:d,num:this.checknum,buy_type:0});console.log(JSON.parse(g)),this.$utils.post(n,g).then((function(e){console.log("res"),console.log(e),1==e.sta&&o.showToast({icon:"success",title:"添加成功",duration:1e3});var i=0,t=o.getStorageSync("id");s.memberid=t;var n='{"memberid":"'+t+'","buy_type":"'+i+'"}',c="get_buy_shopping_cart";s.$utils.post(c,n).then((function(o){console.log("商品信息",o),s.num_all=o.rs.num_all}))}))}else o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(e){setTimeout((function(e){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+i.keynum})}),500)}})},bottom_btn:function(e){var s=this,i=o.getStorageSync("id");i?o.reLaunch({url:"../shopping/shopping?type=0"}):o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(e){setTimeout((function(e){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+s.keynum})}),500)}})},onPageScroll:function(o){this.tt;this.scrollTop=o.scrollTop},scrolle:function(e){var s=this;if(console.log(this.fixed),0==this.fixed)var i=setTimeout((function(){console.log("执行??"),o.pageScrollTo({scrollTop:s.top}),clearTimeout(i)}),100)},spec:function(o){console.log(o);var e=o.currentTarget.dataset.one,s=o.currentTarget.dataset.index,i=o.currentTarget.dataset.text;o.currentTarget.dataset.da;console.log("点击规格",o);var t=this.goods_spec,n=this.goods_item,c=this.first,r=this.arr,l=this.specArr;this.choose.length;console.log(t),console.log(n),t.push(e),c.splice(0,1),r.splice(0,1),-1==c.indexOf(e)&&c.push(e),-1==r.indexOf(s)&&r.push(l),console.log(l[e]==i),l[e]==i?l[e]=null:l[e]=i,t=Object.keys(l),n=Object.values(l),console.log(l),console.log(t),console.log(n),this["guige"]=n,console.log(this.guige.join(","))},open:function(){var e=this,s=o.getStorageSync("openid");s?(this.openid=s,console.log("已获取openid")):o.login({success:function(s){var i='{"wx_code":"'+s.code+'"}',t="get_openid";e.$utils.post(t,i).then((function(s){console.log("openid",s),o.setStorageSync("openid",s.openid),e.openid=s.openid}))}})},bindGetUserInfo:function(e){e.detail.rawData&&(this.Data=JSON.parse(e.detail.rawData),o.showLoading({title:"登录中",mask:"true"}),this.zhu())},zhu:function(){var e=this,s=this.Data,i=this.openid;o.setStorageSync("rawdata",s);var t='{"wx_openid":"'+i+'","name":"'+s.nickName+'","sex":"'+s.gender+'","head_img":"'+s.avatarUrl+'"}';console.log(t);var n="member_register";this.$utils.post(n,t).then((function(s){if(console.log("注册",s),"操作成功！"===s.msg||"该用户已经注册,请勿重复注册！"===s.msg){var t='{"wx_openid":"'+i+'"}',n="member_login";e.$utils.post(n,t).then((function(s){o.hideLoading(),console.log("基本信息",s.rs),o.setStorageSync("sign",s.rs),o.setStorageSync("id",s.rs.id),o.setStorageSync("name",s.rs.name),o.setStorageSync("keynum",s.rs.keynum),o.setStorageSync("sex",s.rs.sex),o.setStorageSync("head_img",s.rs.head_img),o.setStorageSync("level_name",s.rs.level_name),o.setStorageSync("level",s.rs.lmevemml),o.setStorageSync("balance",s.rs.balance),o.setStorageSync("zj_balance",s.rs.zj_balance),o.setStorageSync("phone",s.rs.phone),null==s.rs.discount_name||""==s.rs.discount_name||o.setStorageSync("discount_name",s.rs.discount_name),e.showa=1,e.sta=200;var i='{"keynum":"'+e.keynum+'","memberid":"'+s.rs.id+'"}';console.log(i);var t="get_goods_detail";e.$utils.post(t,i).then((function(o){if(console.log("详情",o.rs.goodsinfo),e.head_img=o.rs.goodsinfo.head_img,o.rs.goodsinfo.images){var s=o.rs.goodsinfo.images.split("|");s.unshift(o.rs.goodsinfo.head_img),e.details=s}for(var i in e.text=o.rs.goodsinfo.goods_spec.length,e.text1=o.rs.goodsinfo.goods_spec_list.length,o.rs.goodsinfo.discount_name1=(o.rs.goodsinfo.price_level1/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name2=(o.rs.goodsinfo.price_level2/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name3=(o.rs.goodsinfo.price_level3/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name4=(o.rs.goodsinfo.price_level4/o.rs.goodsinfo.price*10).toFixed(1)+"折",e.alt=o.rs.goodsinfo,e.specifications=o.rs.goodsinfo.goods_spec_list,e.list=o.rs.goodsinfo.goods_spec_list,o.rs.goodsinfo.goods_spec)o.rs.goodsinfo.goods_spec[i].one=i;e.btmdetails=o.rs.goodsinfo.details.replace(/<img /g,'<img class="rich_img" '),e.choose=o.rs.goodsinfo.goods_spec,e.goodsid=o.rs.goodsinfo.id,1==o.rs.goodsinfo.is_collect&&(e.icon[1].src="../../static/shoucang-on.png")}));i="{}",t="get_webconfig_tiaoli";e.$utils.post(t,i).then((function(o){console.log("赠礼须知"),o.rs.zenglixuzhi,e.btmnotice=o.rs.zenglixuzhi.replace(/<img /g,'<img class="rich_img" ')}))}))}}))},gotoShare:function(){var e=this,s=o.getStorageSync("id");s?this.$refs.popup.open():o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(s){setTimeout((function(s){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+e.keynum})}),500)}})},close1:function(){this.$refs.popup.close()},confirm_order:function(e){var s=e.currentTarget.dataset.keynum;o.navigateTo({url:"../index-coupon/ExchangeDetails?keynum="+s+"&isShow=2"})},changeswiper:function(o){var e=o.detail,s=(e.current,e.source);"autoplay"!==s&&"touch"!==s||(this.swiperCurrentIndex=o.detail.current+1)}}};e.default=a}).call(this,s("543d")["default"])},"497f":function(o,e,s){"use strict";(function(o){s("334b");i(s("66fd"));var e=i(s("b055"));function i(o){return o&&o.__esModule?o:{default:o}}o(e.default)}).call(this,s("543d")["createPage"])},"4e91":function(o,e,s){"use strict";s.d(e,"b",(function(){return t})),s.d(e,"c",(function(){return n})),s.d(e,"a",(function(){return i}));var i={uniPopup:function(){return s.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(s.bind(null,"f3d2"))}},t=function(){var o=this,e=o.$createElement,s=(o._self._c,o.$utils.imageUrl(o.head_img)),i=o.alt.goodsname.substr(0,10),t=o.details.length>0?o.__map(o.details,(function(e,s){var i=o.__get_orig(e),t=o.$utils.imageUrl(e);return{$orig:i,g2:t}})):null,n=o.details.length>0?null:o.$utils.imageUrl(o.head_img),c=1==o.alt.is_currency_type&&o.alt.client_card_goods_list.length>0?o.__map(o.alt.client_card_goods_list,(function(e,s){var i=o.__get_orig(e),t=o.$utils.imageUrl(e.head_img);return{$orig:i,g4:t}})):null;o.$mp.data=Object.assign({},{$root:{g0:s,g1:i,l0:t,g3:n,l1:c}})},n=[]},"5e44":function(o,e,s){"use strict";var i=s("f6d9"),t=s.n(i);t.a},8955:function(o,e,s){"use strict";s.r(e);var i=s("1336"),t=s.n(i);for(var n in i)"default"!==n&&function(o){s.d(e,o,(function(){return i[o]}))}(n);e["default"]=t.a},b055:function(o,e,s){"use strict";s.r(e);var i=s("4e91"),t=s("8955");for(var n in t)"default"!==n&&function(o){s.d(e,o,(function(){return t[o]}))}(n);s("5e44");var c,r=s("f0c5"),l=Object(r["a"])(t["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],c);e["default"]=l.exports},f6d9:function(o,e,s){}},[["497f","common/runtime","common/vendor"]]]);