(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/details/details"],{1336:function(o,s,e){"use strict";(function(o){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,e("24d7");var t=a(e("e2fe")),i=a(e("e56b")),n=a(e("da8a"));function a(o){return o&&o.__esModule?o:{default:o}}function c(o,s,e){return s in o?Object.defineProperty(o,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[s]=e,o}var r=function(){e.e("components/own-components/own-coupon-list/own-coupon-list").then(function(){return resolve(e("811e"))}.bind(null,e)).catch(e.oe)},l=function(){Promise.all([e.e("common/vendor"),e.e("components/feng-parse/parse")]).then(function(){return resolve(e("6551"))}.bind(null,e)).catch(e.oe)},d={components:{uParse:l,"own-coupon-list":r},data:function(){var o;return o={num_all:0,btns:0,fixed:!1,list:[],display:!1,commom:"details-choose-left details-choose-active",commom1:"details-choose-left",img:!0,details:[],indexNav:[{name:"热门",style:"color:#FF0022;border-bottom:4.16rpx solid #FF0022;"},{name:"情人节"},{name:"夏日防暑"},{name:"9.9包邮"},{name:"美物"},{name:"热门"},{name:"情人节"}],alt:"",text:"",text1:"",choose:[{src:"../../static/details-small.jpg"},{src:"../../static/details-small.jpg"},{src:"../../static/details-small.jpg"},{src:"../../static/details-small.jpg"},{src:"../../static/details-small.jpg"},{src:"../../static/details-small1.jpg"},{src:"../../static/details-small1.jpg"},{src:"../../static/details-small1.jpg"},{src:"../../static/details-small1.jpg"},{src:"../../static/details-small1.jpg"}],id:"",goods_model:"",goods_spec:[0],goods_item:["默认"],discount_name:"",level_name:"",level:"",images:"",head_img:"",arr:[],first:[],btmdetails:"",btmnotice:"",btm:!0,listdisplay:!1,scrollTop:"",tt:[],top:"",keynum:"",sta:"",openid:"",Data:"",specArr:{},url:"",couponList:[],goodsinfo:{}},c(o,"goods_item",""),c(o,"guige",[]),c(o,"checknum","1"),c(o,"swiperCurrentIndex",1),c(o,"action_type","append_to_cart"),o},onLoad:function(s){var e=this;this.url=t.default.URL,console.log(s),console.log("我执行了");var n=decodeURIComponent(s.scene);s.keynum?this.keynum=s.keynum:this.keynum=n,this.level_name=o.getStorageSync("level_name"),console.log(this.level_name),this.level=o.getStorageSync("level"),this.discount_name=o.getStorageSync("discount_name"),this.id=o.getStorageSync("id");var a=o.getStorageSync("id"),c='{"keynum":"'+this.keynum+'","memberid":"'+a+'"}';console.log(c);var r="get_goods_detail";this.$utils.post(r,c).then((function(o){console.log("res： ",o),console.log("详情",o.rs.goodsinfo),e.goodsinfo=o.rs.goodsinfo,i.default.track("browse_sku_page",{sku:{sku_id:e.goodsinfo.sku+"",sku_name:e.goodsinfo.goodsname},spu:{spu_id:e.goodsinfo.spu+"",spu_name:e.goodsinfo.goodsname},primary_image_url:e.goodsinfo.head_img});var s,t,n,a=JSON.stringify({memberid:e.id,goodsid:e.goodsinfo.id}),c="get_coupon_list";if(e.$utils.post(c,a).then((function(o){console.log(),e.couponList=o.rs})),e.head_img=o.rs.goodsinfo.head_img,o.rs.goodsinfo.images){var r=o.rs.goodsinfo.images.split("|");r.unshift(o.rs.goodsinfo.head_img),e.details=r}for(var l in e.num_all=o.rs.goodsinfo.buy_shopping_cart_number,e.text=o.rs.goodsinfo.goods_spec.length,e.text1=o.rs.goodsinfo.goods_spec_list.length,console.log("规格",o.rs.goodsinfo.goods_spec),o.rs.goodsinfo.discount_name1=(o.rs.goodsinfo.price_level1/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name2=(o.rs.goodsinfo.price_level2/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name3=(o.rs.goodsinfo.price_level3/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name4=(o.rs.goodsinfo.price_level4/o.rs.goodsinfo.price*10).toFixed(1)+"折",e.alt=o.rs.goodsinfo,e.specifications=o.rs.goodsinfo.goods_spec_list,e.goods_model=o.rs.goodsinfo.goods_model,e.list=o.rs.goodsinfo.goods_spec_list,o.rs.goodsinfo.goods_spec)o.rs.goodsinfo.goods_spec[l].one=l;e.btmdetails=o.rs.goodsinfo.details.replace(/<img /g,'<img class="rich_img" '),e.choose=o.rs.goodsinfo.goods_spec,e.goodsid=o.rs.goodsinfo.id,console.log("礼篮"),1==o.rs.goodsinfo.goods_spec.length&&1==o.rs.goodsinfo.goods_spec.goods_spec_item&&(e.goods_spec=[0],e.goods_item=[o.rs.goodsinfo.goods_spec.goods_spec_item]);var d=e.goods_spec,g=e.goods_item,u=e.first,m=e.arr,h=e.specArr;if(e.choose.length>0)for(var _ in e.choose){var p=e.choose[_],f=p.goods_spec_item;for(var v in s=p.one,d.push(s),u.splice(0,1),m.splice(0,1),-1==u.indexOf(s)&&u.push(s),f){var y=f[0];t=v,n=y.item,-1==m.indexOf(t)&&m.push(h),h[s]=n}}d=Object.keys(h),g=Object.values(h),e["guige"]=g,console.log(e.guige.join(","))}));c="{}",r="get_webconfig_tiaoli";this.$utils.post(r,c).then((function(o){console.log("赠礼须知"),o.rs.zenglixuzhi,e.btmnotice=o.rs.zenglixuzhi.replace(/<img /g,'<img class="rich_img" ')}));var l=o.getStorageSync("sign");l?this.sta="200":(this.open(),this.sta="0")},onShow:function(){this.goodsinfo&&this.goodsinfo.id&&i.default.track("browse_sku_page",{sku:{sku_id:this.goodsinfo.sku+"",sku_name:this.goodsinfo.goodsname},spu:{spu_id:this.goodsinfo.spu+"",spu_name:this.goodsinfo.goodsname},primary_image_url:this.goodsinfo.head_img})},onShareAppMessage:function(o){return this.$refs.popup.close(),{imageUrl:this.alt.head_img,title:"我发现了一份不错的礼物，快来看看吧！",path:"/pages/details/details?keynum="+this.keynum,desc:"指间送礼"}},computed:{selectOption:function(){return this.goods_item}},methods:{firend:function(s){this.$refs.popup.close(),o.navigateTo({url:"./detailsshare?keynum=".concat(this.keynum,"&imageUrl=").concat(this.head_img,"&goodsname=").concat(this.alt.goodsname)})},trackClick:function(o){n.default.trackEvent("Um_Event_kefu",{Um_Key_ItemName:"客服"}),i.default.track("start_consult",{action_type:"consult_online"})},reduce:function(s,e,t){var i,n=parseInt(s);1==e?(n++,i="append_to_cart"):(n--,i="remove_from_cart"),n<1?o.showToast({title:"商品购买数量最少一个",mask:!0,icon:"none"}):(this.action_type=i,this.checknum=parseInt(n))},handleSelect:function(o){this.goods_item=o,console.log("----\x3e:",o)},join:function(o){var s=o.currentTarget.dataset.index;0==s?(this.commom="details-choose-left details-choose-active",this.commom1="details-choose-left",this.img=!0,this.btm=!0):(this.commom1="details-choose-left details-choose-active",this.commom="details-choose-left",this.img=!1,this.btm=!1)},goshop:function(o){this.btns=2;var s=0;this.display=!this.display,this.fixed=!0,console.log("打开商品规格"),0==s&&(console.log(this.scrollTop),s++)},lilan:function(s){var e=this,t=o.getStorageSync("id");if(t){this.btns=3;var i=0;return this.display=!this.display,this.fixed=!0,console.log("打开商品规格"),void(0==i&&(console.log(this.scrollTop),i++))}o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(s){setTimeout((function(s){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+e.keynum})}),500)}})},meshop:function(){},list_speci:function(o){this.btns=1,console.log(this.text);var s=0;this.display=!this.display,this.fixed=!0,console.log("打开商品规格"),0==s&&(console.log(this.scrollTop),s++);var e="get_goods_detail",t=JSON.stringify({memberid:this.id,goodsid:this.goodsinfo.id,goods_model:this.goodsinfo.goods_model,spec_name:this.goodsinfo["goods_spec"][0]["spec_name"],goods_spec:this.goodsinfo["goods_spec"][0]["id"],goods_item:this.goodsinfo["goods_spec"][0]["goods_spec_item"][0]["item"]});this.$utils.post(e,t).then((function(o){console.log(o)}))},close:function(o){console.log("关闭规格"),this.display=!1,this.fixed=!1,this.scrolle()},determine1:function(s){var e=this.guige.join("");n.default.trackEvent("Um_Event_ShopBuy",{Um_Key_ItemTtile:"直接购买",Um_Key_ItemName:this.goodsinfo.goodsname,Um_Key_ItemId:this.goodsinfo.sku}),i.default.track("add_to_cart",{action_type:"append_to_cart",sku:{sku_id:this.goodsinfo.sku+"",sku_name:this.goodsinfo.goodsname+e},spu:{spu_id:this.goodsinfo.spu+"",spu_name:this.goodsinfo.goodsname},sku_num:parseInt(this.checknum),primary_image_url:this.goodsinfo.head_img});var t=this,a=o.getStorageSync("id");if(a){console.log("确定规格"),this.display=!1,this.fixed=!1;var c="op_buy_shopping_cart",r=this.id,l=this.goodsid,d=this.goods_model,g=String(Object.keys(this.specArr)),u=String(Object.values(this.specArr)).replace("#","替换u35");console.log(u);var m=JSON.stringify({memberid:r,goodsid:l,goods_model:d,goods_spec:g,goods_item:u,num:this.checknum,buy_type:1});console.log(m),this.$utils.post(c,m).then((function(s){console.log(s+"直接购买");var e="success";if(1!=s.sta)return e="none",void o.showToast({icon:e,title:s.msg,duration:2e3});""!=u&&o.navigateTo({url:"../shopping/must?type=1"})})),this.scrolle()}else o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(s){setTimeout((function(s){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+t.keynum})}),500)}})},determine2:function(s){var e=this.guige.join("");n.default.trackEvent("Um_Event_ShopZengSong",{Um_Key_ItemTtile:"直接赠送",Um_Key_ItemName:this.goodsinfo.goodsname,Um_Key_ItemId:this.goodsinfo.sku}),i.default.track("add_to_cart",{action_type:"append_to_cart",sku:{sku_id:this.goodsinfo.sku+"",sku_name:this.goodsinfo.goodsname+e},spu:{spu_id:this.goodsinfo.spu+"",spu_name:this.goodsinfo.goodsname},sku_num:parseInt(this.checknum),primary_image_url:this.goodsinfo.head_img});var t=this,a=o.getStorageSync("id");if(a){console.log("确定规格"),this.display=!1,this.fixed=!1;var c="op_buy_shopping_cart",r=this.id,l=this.goodsid,d=this.goods_model,g=String(Object.keys(this.specArr)),u=String(Object.values(this.specArr)).replace("#","替换u35");console.log(u);var m=JSON.stringify({memberid:r,goodsid:l,goods_model:d,goods_spec:g,goods_item:u,num:this.checknum,buy_type:1});this.$utils.post(c,m).then((function(s){console.log("直接赠送"),console.log(s);var e="success";if(1!=s.sta)return e="none",void o.showToast({icon:e,title:s.msg,duration:2e3});""!=u&&o.redirectTo({url:"../shopping/shop?type=1"})})),this.scrolle()}else o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(s){setTimeout((function(s){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+t.keynum})}),500)}})},determine3:function(s){var e=this,t=this.guige.join("");n.default.trackEvent("Um_Event_lilan",{Um_Key_ItemTtile:"加入礼篮",Um_Key_ItemName:this.goodsinfo.goodsname,Um_Key_ItemId:this.goodsinfo.sku}),i.default.track("add_to_cart",{action_type:"append_to_cart",sku:{sku_id:this.goodsinfo.sku+"",sku_name:this.goodsinfo.goodsname+t},spu:{spu_id:this.goodsinfo.spu+"",spu_name:this.goodsinfo.goodsname},sku_num:parseInt(this.checknum),primary_image_url:this.goodsinfo.head_img});var a=this,c=o.getStorageSync("id");if(c){this.display=!1,this.fixed=!1;var r="op_buy_shopping_cart",l=this.id,d=this.goodsid,g=this.goods_model,u=String(Object.keys(this.specArr)),m=String(Object.values(this.specArr)).replace("#","替换u35"),h=JSON.stringify({memberid:l,goodsid:d,goods_model:g,goods_spec:u,goods_item:m,num:this.checknum,buy_type:0});console.log(JSON.parse(h)),this.$utils.post(r,h).then((function(s){console.log("res"),console.log(s),1==s.sta&&o.showToast({icon:"success",title:"添加成功",duration:1e3});var t=0,i=o.getStorageSync("id");e.memberid=i;var n='{"memberid":"'+i+'","buy_type":"'+t+'"}',a="get_buy_shopping_cart";e.$utils.post(a,n).then((function(o){console.log("商品信息",o),e.num_all=o.rs.num_all}))}))}else o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(s){setTimeout((function(s){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+a.keynum})}),500)}})},bottom_btn:function(s){var e=this,t=o.getStorageSync("id");t?(n.default.trackEvent("Um_Event_ToLiLan",{Um_Key_ItemName:"进入礼篮"}),o.reLaunch({url:"../shopping/shopping?type=0"})):o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(s){setTimeout((function(s){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+e.keynum})}),500)}})},onPageScroll:function(o){this.tt;this.scrollTop=o.scrollTop},scrolle:function(s){var e=this;if(console.log(this.fixed),0==this.fixed)var t=setTimeout((function(){console.log("执行??"),o.pageScrollTo({scrollTop:e.top}),clearTimeout(t)}),100)},spec:function(o){console.log(o);var s=o.currentTarget.dataset.one,e=o.currentTarget.dataset.index,t=o.currentTarget.dataset.text;o.currentTarget.dataset.da;console.log("点击规格",o);var i=this.goods_spec,n=this.goods_item,a=this.first,c=this.arr,r=this.specArr;this.choose.length;console.log(i),console.log(n),i.push(s),a.splice(0,1),c.splice(0,1),-1==a.indexOf(s)&&a.push(s),-1==c.indexOf(e)&&c.push(r),console.log(r[s]==t),r[s]==t?r[s]=null:r[s]=t,i=Object.keys(r),n=Object.values(r),console.log(r),console.log(i),console.log(n),this["guige"]=n,console.log(this.guige.join(","))},open:function(){var s=this,e=o.getStorageSync("openid");e?(this.openid=e,console.log("已获取openid")):o.login({success:function(e){var t='{"wx_code":"'+e.code+'"}',i="get_openid";s.$utils.post(i,t).then((function(e){console.log("openid",e),o.setStorageSync("openid",e.openid),s.openid=e.openid}))}})},bindGetUserInfo:function(s){s.detail.rawData&&(this.Data=JSON.parse(s.detail.rawData),o.showLoading({title:"登录中",mask:"true"}),this.zhu())},zhu:function(){var s=this,e=this.Data,t=this.openid;o.setStorageSync("rawdata",e);var i='{"wx_openid":"'+t+'","name":"'+e.nickName+'","sex":"'+e.gender+'","head_img":"'+e.avatarUrl+'"}';console.log(i);var n="member_register";this.$utils.post(n,i).then((function(e){if(console.log("注册",e),"操作成功！"===e.msg||"该用户已经注册,请勿重复注册！"===e.msg){var i='{"wx_openid":"'+t+'"}',n="member_login";s.$utils.post(n,i).then((function(e){o.hideLoading(),console.log("基本信息",e.rs),o.setStorageSync("sign",e.rs),o.setStorageSync("id",e.rs.id),o.setStorageSync("name",e.rs.name),o.setStorageSync("keynum",e.rs.keynum),o.setStorageSync("sex",e.rs.sex),o.setStorageSync("head_img",e.rs.head_img),o.setStorageSync("level_name",e.rs.level_name),o.setStorageSync("level",e.rs.lmevemml),o.setStorageSync("balance",e.rs.balance),o.setStorageSync("zj_balance",e.rs.zj_balance),o.setStorageSync("phone",e.rs.phone),null==e.rs.discount_name||""==e.rs.discount_name||o.setStorageSync("discount_name",e.rs.discount_name),s.showa=1,s.sta=200;var t='{"keynum":"'+s.keynum+'","memberid":"'+e.rs.id+'"}';console.log(t);var i="get_goods_detail";s.$utils.post(i,t).then((function(o){if(console.log("详情",o.rs.goodsinfo),s.head_img=o.rs.goodsinfo.head_img,o.rs.goodsinfo.images){var e=o.rs.goodsinfo.images.split("|");e.unshift(o.rs.goodsinfo.head_img),s.details=e}for(var t in s.text=o.rs.goodsinfo.goods_spec.length,s.text1=o.rs.goodsinfo.goods_spec_list.length,o.rs.goodsinfo.discount_name1=(o.rs.goodsinfo.price_level1/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name2=(o.rs.goodsinfo.price_level2/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name3=(o.rs.goodsinfo.price_level3/o.rs.goodsinfo.price*10).toFixed(1)+"折",o.rs.goodsinfo.discount_name4=(o.rs.goodsinfo.price_level4/o.rs.goodsinfo.price*10).toFixed(1)+"折",s.alt=o.rs.goodsinfo,s.specifications=o.rs.goodsinfo.goods_spec_list,s.list=o.rs.goodsinfo.goods_spec_list,o.rs.goodsinfo.goods_spec)o.rs.goodsinfo.goods_spec[t].one=t;s.btmdetails=o.rs.goodsinfo.details.replace(/<img /g,'<img class="rich_img" '),s.choose=o.rs.goodsinfo.goods_spec,s.goodsid=o.rs.goodsinfo.id,1==o.rs.goodsinfo.is_collect&&(s.icon[1].src="../../static/shoucang-on.png")}));t="{}",i="get_webconfig_tiaoli";s.$utils.post(i,t).then((function(o){console.log("赠礼须知"),o.rs.zenglixuzhi,s.btmnotice=o.rs.zenglixuzhi.replace(/<img /g,'<img class="rich_img" ')}))}))}}))},gotoShare:function(){var s=this,e=o.getStorageSync("id");e?(n.default.trackEvent("Um_Event_firend",{Um_Key_ItemName:"求礼物"}),this.$refs.popup.open()):o.showToast({title:"请先登录",icon:"none",mask:"true",success:function(e){setTimeout((function(e){o.reLaunch({url:"../signin/signin?receive=ondetails&keynum="+s.keynum})}),500)}})},close1:function(){this.$refs.popup.close()},confirm_order:function(s){var e=s.currentTarget.dataset.keynum;n.default.trackEvent("Um_Event_ExchangeDetails",{Um_Key_ItemName:"兑换商品详情"}),o.navigateTo({url:"../index-coupon/ExchangeDetails?keynum="+e+"&isShow=2"})},changeswiper:function(o){var s=o.detail,e=(s.current,s.source);"autoplay"!==e&&"touch"!==e||(this.swiperCurrentIndex=o.detail.current+1)}}};s.default=d}).call(this,e("543d")["default"])},"497f":function(o,s,e){"use strict";(function(o){e("334b");t(e("66fd"));var s=t(e("b055"));function t(o){return o&&o.__esModule?o:{default:o}}o(s.default)}).call(this,e("543d")["createPage"])},"5e44":function(o,s,e){"use strict";var t=e("f6d9"),i=e.n(t);i.a},8955:function(o,s,e){"use strict";e.r(s);var t=e("1336"),i=e.n(t);for(var n in t)"default"!==n&&function(o){e.d(s,o,(function(){return t[o]}))}(n);s["default"]=i.a},b055:function(o,s,e){"use strict";e.r(s);var t=e("e646"),i=e("8955");for(var n in i)"default"!==n&&function(o){e.d(s,o,(function(){return i[o]}))}(n);e("5e44");var a,c=e("f0c5"),r=Object(c["a"])(i["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],a);s["default"]=r.exports},e646:function(o,s,e){"use strict";e.d(s,"b",(function(){return i})),e.d(s,"c",(function(){return n})),e.d(s,"a",(function(){return t}));var t={uniPopup:function(){return e.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(e.bind(null,"f3d2"))}},i=function(){var o=this,s=o.$createElement,e=(o._self._c,o.$utils.imageUrl(o.head_img)),t=o.alt.goodsname.substr(0,10),i=o.details.length>0?o.__map(o.details,(function(s,e){var t=o.__get_orig(s),i=o.$utils.imageUrl(s);return{$orig:t,g2:i}})):null,n=o.details.length>0?null:o.$utils.imageUrl(o.head_img),a=1==o.alt.is_currency_type&&o.alt.client_card_goods_list.length>0?o.__map(o.alt.client_card_goods_list,(function(s,e){var t=o.__get_orig(s),i=o.$utils.imageUrl(s.head_img);return{$orig:t,g4:i}})):null;o.$mp.data=Object.assign({},{$root:{g0:e,g1:t,l0:i,g3:n,l1:a}})},n=[]},f6d9:function(o,s,e){}},[["497f","common/runtime","common/vendor"]]]);