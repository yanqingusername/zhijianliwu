(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/details/detailsshare"],{"284c":function(n,t,e){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(e("a34a")),o=r(e("e2fe"));function r(n){return n&&n.__esModule?n:{default:n}}function s(n,t,e,a,o,r,s){try{var i=n[r](s),c=i.value}catch(u){return void e(u)}i.done?t(c):Promise.resolve(c).then(a,o)}function i(n){return function(){var t=this,e=arguments;return new Promise((function(a,o){var r=n.apply(t,e);function i(n){s(r,a,o,i,c,"next",n)}function c(n){s(r,a,o,i,c,"throw",n)}i(void 0)}))}}var c=function(){Promise.all([e.e("common/vendor"),e.e("components/r-canvas/r-canvas")]).then(function(){return resolve(e("c910"))}.bind(null,e)).catch(e.oe)},u={components:{rCanvas:c},data:function(){return{keynum:"",QRcodeUrl:"",imageUrl:"",goodsname:"",posterUrl:"",url:"",bgUrl:"https://slxcx.oss-cn-beijing.aliyuncs.com/xcx-static/payment/gift_hb.png",flowUrl:"https://slxcx.oss-cn-beijing.aliyuncs.com/xcx-static/payment/hdj.png"}},onLoad:function(t){var e=this;if(this.url=o.default.URL,t&&t.keynum&&t.imageUrl&&t.goodsname){this.keynum=t.keynum,this.imageUrl=t.imageUrl,this.goodsname=t.goodsname,n.showToast({title:"生成中",icon:"loading"});var r="get_haibao",s=JSON.stringify({scene:this.keynum,page:"pages/details/details"});this.$utils.post(r,s).then((function(n){console.log(n),e.QRcodeUrl=e.url+n.dir,console.log("QRcodeUrl:",e.QRcodeUrl)})).then((function(t){e.$nextTick(i(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.rCanvas.init({canvas_id:"rCanvas",canvas_width:375,canvas_height:540,hidden:!0});case 2:return t.next=4,e.$refs.rCanvas.drawImage({url:e.$utils.imageUrl(e.bgUrl),x:15,y:10,w:350,h:520}).catch((function(t){n.showToast({title:t,icon:"none"})}));case 4:return t.next=6,e.$refs.rCanvas.fillRoundRect({x:100,y:100,w:180,h:200,radius:10,fill_color:"#CCB586"});case 6:return t.next=8,e.$refs.rCanvas.fillRoundRect({x:102,y:102,w:176,h:196,radius:10,fill_color:"rgb(255, 255, 255)"});case 8:return t.next=10,e.$refs.rCanvas.drawImage({url:e.$utils.imageUrl(e.flowUrl),x:180,y:90,w:20,h:20}).catch((function(t){n.showToast({title:t,icon:"none"})}));case 10:return t.next=12,e.$refs.rCanvas.drawImage({url:e.$utils.imageUrl(e.imageUrl),x:125,y:130,w:130,h:120}).catch((function(t){n.showToast({title:t,icon:"none"})}));case 12:return t.next=14,e.$refs.rCanvas.drawText({text:e.$utils.sub_str(e.goodsname,7),x:135,y:280,max_width:140,font_color:"#333333",font_size:14}).catch((function(t){n.showToast({title:t,icon:"none"})}));case 14:return t.next=16,e.$refs.rCanvas.drawText({text:"我发现了一份不错的礼物，快来看看吧！",x:60,y:340,font_color:"#FADEA5",font_size:15}).catch((function(t){n.showToast({title:t,icon:"none"})}));case 16:return t.next=18,e.$refs.rCanvas.drawImage({url:e.$utils.imageUrl(e.QRcodeUrl),x:150,y:368,w:80,h:80,radius:16,is_radius:!0}).catch((function(t){n.showToast({title:t,icon:"none"})}));case 18:return t.next=20,e.$refs.rCanvas.drawText({text:"长按小程序码领礼物",x:130,y:470,max_width:130,font_color:"#FFF8F8",font_size:14}).catch((function(t){n.showToast({title:t,icon:"none"})}));case 20:return t.next=22,e.$refs.rCanvas.drawText({text:"先到先得",x:160,y:490,max_width:130,font_color:"#FFF8F8",font_size:14}).catch((function(t){n.showToast({title:t,icon:"none"})}));case 22:return t.next=24,e.$refs.rCanvas.draw((function(t){n.hideLoading(),e.posterUrl=t.tempFilePath}));case 24:case"end":return t.stop()}}),t)}))))}))}},methods:{down:function(t){n.saveImageToPhotosAlbum({filePath:this.posterUrl,success:function(t){n.showToast({title:"图片已保存",icon:"none"})},fail:function(t){"saveImageToPhotosAlbum:fail:auth denied"!==t.errMsg&&"saveImageToPhotosAlbum:fail auth deny"!==t.errMsg&&"saveImageToPhotosAlbum:fail authorize no response"!==t.errMsg||n.showModal({title:"提示",content:"需要您授权保存相册",showCancel:!1,success:function(t){n.openSetting({success:function(n){n.authSetting["scope.writePhotosAlbum"]}})}})}})}}};t.default=u}).call(this,e("543d")["default"])},"4e63":function(n,t,e){"use strict";var a=e("ad9f"),o=e.n(a);o.a},"578e":function(n,t,e){"use strict";e.r(t);var a=e("284c"),o=e.n(a);for(var r in a)"default"!==r&&function(n){e.d(t,n,(function(){return a[n]}))}(r);t["default"]=o.a},"863f":function(n,t,e){"use strict";e.d(t,"b",(function(){return o})),e.d(t,"c",(function(){return r})),e.d(t,"a",(function(){return a}));var a={rCanvas:function(){return Promise.all([e.e("common/vendor"),e.e("components/r-canvas/r-canvas")]).then(e.bind(null,"c910"))}},o=function(){var n=this,t=n.$createElement,e=(n._self._c,n.$utils.imageUrl(n.posterUrl));n.$mp.data=Object.assign({},{$root:{g0:e}})},r=[]},a04f:function(n,t,e){"use strict";(function(n){e("334b");a(e("66fd"));var t=a(e("a48f"));function a(n){return n&&n.__esModule?n:{default:n}}n(t.default)}).call(this,e("543d")["createPage"])},a48f:function(n,t,e){"use strict";e.r(t);var a=e("863f"),o=e("578e");for(var r in o)"default"!==r&&function(n){e.d(t,n,(function(){return o[n]}))}(r);e("4e63");var s,i=e("f0c5"),c=Object(i["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],s);t["default"]=c.exports},ad9f:function(n,t,e){}},[["a04f","common/runtime","common/vendor"]]]);